{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Raivex\\\\Desktop\\\\THESIS\\\\musimu\\\\gui\\\\src\\\\simulator\\\\Board.js\";\nimport React, { Component } from \"react\";\nimport Row from \"./Row\";\nimport Timer from \"./Timer\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Board extends Component {\n  constructor(props) {\n    super(props);\n\n    this.ks1 = (cell, xValue, mx, my) => {\n      if (this.props.handle === 0) {\n        let currentSelected = xValue;\n        let row = this.state.row;\n        row[currentSelected][0].accidental = this.props.accidental;\n        this.setState({\n          row\n        });\n        this.ks2(cell, currentSelected, mx, my);\n      }\n    };\n\n    this.ks2 = (cell, currentSelected, mx, my, kind) => {\n      let type = 5;\n      let row = this.state.row;\n      console.log(row[currentSelected][0]);\n\n      if (this.props.handle === 0) {\n        if (kind === undefined) {\n          if (row[currentSelected][0].starting !== true) {\n            return;\n          } // --------------debuged--------------------\n          //all y in x ---- means -----  check column\n\n\n          if (row[currentSelected][0].accLocation[mx][my].my === false) {\n            row[currentSelected][0].accLocation[mx][my].my = true;\n            row[currentSelected][0].accLocation[mx][my].acc = row[currentSelected][0].accidental;\n            row[currentSelected][0].accLocation[mx][11].my = true;\n          } else {\n            let a = 0;\n            let current = [];\n\n            while (a < 9) {\n              if (row[currentSelected][0].accLocation[mx][a].my === true && my !== a) {\n                current.push(a);\n              }\n\n              a++;\n\n              if (a === 9) {\n                a = 0;\n                break;\n              }\n            }\n\n            let b = 0;\n            let currentNext = [];\n\n            if (mx !== 6) {\n              while (b < 9) {\n                if (row[currentSelected][0].accLocation[mx + 1][b].my === true) {\n                  currentNext.push(b);\n                }\n\n                b++;\n              }\n            }\n\n            if (mx === 6) {\n              row[currentSelected][0].accLocation[6][my].my = false;\n              console.log(\"a\");\n            }\n\n            if (current.length === 0 && currentNext.length === 0) {\n              row[currentSelected][0].accLocation[mx][my].my = false;\n              row[currentSelected][0].accLocation[mx][11].my = false;\n              console.log(\"b\");\n            }\n\n            if (current.length !== 0 && currentNext.length !== 0) {\n              row[currentSelected][0].accLocation[mx][my].my = false;\n              console.log(\"c\");\n            }\n\n            if (current.length !== 0 && currentNext.length === 0) {\n              row[currentSelected][0].accLocation[mx][my].my = false;\n              console.log(\"d\");\n            }\n          }\n        } //--------------------------------------------------Checking-----------------------------------------\n\n\n        let a = [];\n\n        for (let x = 0; x <= 6; x++) {\n          let y = 0;\n\n          while (y < 10) {\n            if (row[currentSelected][0].accLocation[x][y].my === true) {\n              a.push({\n                acc: row[currentSelected][0].accLocation[x][y].acc,\n                x: x,\n                y: y\n              });\n            }\n\n            y++;\n          }\n        }\n\n        let xDup = false;\n\n        for (let c = 0; c < a.length; c++) {\n          let xCount = [];\n          let i = 0;\n\n          while (i < a.length) {\n            if (a[i].x === c) {\n              xCount.push(c);\n            }\n\n            i++;\n          }\n\n          if (xCount.length === 0) {\n            break;\n          }\n\n          if (xCount.length > 1) {\n            xDup = true;\n            let error = 8;\n            let measure = row[currentSelected + 1][8].measure;\n            let accidental = row[currentSelected][0].accidental;\n            this.props.consoleWarningKS(type, measure, error, accidental, my, mx);\n          }\n\n          if (xDup === false) {\n            let error = 8;\n            let measure = row[currentSelected + 1][8].measure;\n            let accidental = row[currentSelected][0].accidental;\n            this.props.removeWarning(type, measure, error, accidental, my, mx);\n          }\n        } // ------------------------for y ------------------------------------------------\n\n\n        let yDup = false;\n        let y = 0;\n\n        while (y < 10) {\n          let yCount = [];\n\n          for (let i = 0; i < a.length; i++) {\n            if (a[i].y === y) {\n              yCount.push(i);\n            }\n          }\n\n          if (yCount.length > 1) {\n            yDup = true; // break;\n          }\n\n          y++;\n        }\n\n        if (yDup === true) {\n          let error = 9;\n          let measure = row[currentSelected + 1][8].measure;\n          let accidental = row[currentSelected][0].accidental;\n          this.props.consoleWarningKS(type, measure, error, accidental, my, mx);\n        } else {\n          let error = 9;\n          let measure = row[currentSelected + 1][8].measure;\n          let accidental = row[currentSelected][0].accidental;\n          this.props.removeWarning(type, measure, error, accidental, my, mx);\n        }\n\n        this.setState({\n          row\n        }); // -------------------------------CHECKING IF THE ACCIDENTALS ARE THE SAME ----------------------------\n\n        let mixed = false;\n\n        for (let i = 0; i <= a.length - 1; i++) {\n          if (a[0].acc !== a[i].acc) {\n            mixed = true;\n            break;\n          }\n        }\n\n        if (mixed === true) {\n          console.log(\"different\");\n          let error = 10;\n          let measure = row[currentSelected + 1][8].measure;\n          let accidental = row[currentSelected][0].accidental;\n          this.props.consoleWarningKS(type, measure, error, accidental);\n        } else {\n          let error = 10;\n          let measure = row[currentSelected + 1][8].measure;\n          let accidental = row[currentSelected][0].accidental;\n          this.props.removeWarning(type, measure, error, accidental);\n        } // ----------------------What Key Signature------------------------\n\n\n        if (row[currentSelected][0].clef === null) {\n          console.log(currentSelected, \"it's null\");\n          let error = 11;\n          let measure = row[currentSelected + 1][8].measure;\n          let accidental = row[currentSelected][0].accidental;\n          this.props.consoleWarningKS(type, measure, error, accidental);\n          return;\n        }\n\n        let clef = row[currentSelected][0].clef;\n        this.keySignatureClefCompare(clef, a, currentSelected);\n      } else {\n        console.log(\"Use Select tool to edit Key Signature\");\n      }\n    };\n\n    this.keySignatureClefCompare = (clef, a, currentSelected) => {\n      console.log(a); // -----------set Letters --------------------------\n\n      let row = this.state.row;\n      let letter = [\"G\", \"F\", \"E\", \"D\", \"C\", \"B\", \"A\"];\n      let picker = 0;\n      let round = 0;\n\n      if (clef === \"G\") {\n        round = 0;\n        picker = 0;\n      }\n\n      if (clef === \"F\") {\n        round = 5;\n        picker = 5;\n      }\n\n      for (let x = 0; x < 7; x++) {\n        for (let y = 0; y < 12; y++) {\n          row[currentSelected][0].accLocation[x][y].letter = letter[picker];\n          picker++;\n\n          if (picker === 7) {\n            picker = 0;\n          }\n\n          if (y === 11) {\n            picker = round;\n          }\n        }\n      }\n\n      let alpMap = [\"G\", \"D\", \"A\", \"E\", \"B\", \"F#\", \"C#\", \"F\", \"Bb\", \"Eb\", \"Ab\", \"Db\", \"Gb\", \"Cb\", \"C\"];\n      let keySeq = [\"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\", \"B\", \"E\", \"A\", \"D\", \"G\", \"C\", \"F\"];\n      let addUp = 0;\n      let sequence = [];\n\n      for (let i = 0; i < a.length; i++) {\n        console.log(row[currentSelected][0].accLocation[a[i].x][a[i].y].letter, a[i].acc);\n        sequence.push({\n          letter: row[currentSelected][0].accLocation[a[i].x][a[i].y].letter,\n          acc: a[i].acc\n        });\n      }\n\n      let type = 5;\n      let error = 12;\n      let measure = row[currentSelected + 1][8].measure;\n\n      if (sequence.length === 0) {\n        this.props.removeWarning(type, measure, error);\n      } else {\n        if (a[0].acc === \"b\") {\n          addUp = 7;\n        }\n\n        for (let i = 0; i < a.length; i++) {\n          if (sequence[i].letter === keySeq[i + addUp]) {\n            console.log(sequence[i].letter, keySeq[i + addUp], \"Key of\", alpMap[i + addUp]);\n\n            if (i === a.length - 1) {\n              console.log(sequence[i].letter, keySeq[i], \"Final Key is in Key of\", alpMap[i + addUp]);\n              this.props.removeWarning(type, measure, error);\n              row[currentSelected][0].keySig = alpMap[i + addUp];\n              break;\n            }\n          } else {\n            console.log(\"unkown Key Signature\");\n            this.props.consoleWarningKS(type, measure, error);\n            break;\n          }\n        }\n      }\n\n      console.log(sequence, a.length);\n      console.log(a.length);\n      this.setState({\n        row\n      });\n    };\n\n    this.createRow = (cell, rowX, kind) => {\n      // let currentIndex = this.state.currentIndex;\n      let currentIndex = null;\n\n      if (rowX !== undefined) {\n        currentIndex = rowX;\n      } else {\n        currentIndex = this.state.currentIndex;\n      }\n\n      let row = this.state.row;\n      let column = this.state.column;\n      row.splice(currentIndex, 0, []);\n\n      for (let y = 0; y < column; y++) {\n        if (y !== 0) {\n          if (y !== 8) {\n            row[currentIndex].push({\n              x: currentIndex,\n              y: y,\n              isOpen: false,\n              rest: false,\n              note: 0,\n              lineStaff: false,\n              // gives line on the cell if true -------------------------------\n              clickable: true,\n              // cell will unclicable if enabler is false ----------------------\n              starting: false,\n              firstRow: false\n            });\n          } else {\n            row[currentIndex].push({\n              x: currentIndex,\n              y: y,\n              isOpen: false,\n              rest: false,\n              note: 0,\n              measure: null,\n              lineStaff: false,\n              // gives line on the cell if true -------------------------------\n              clickable: true,\n              // cell will unclicable if enabler is false ----------------------\n              barline: false,\n              starting: false,\n              firstRow: false\n            });\n          }\n        } else {\n          row[currentIndex].push({\n            x: currentIndex,\n            y: y,\n            isOpen: false,\n            rest: false,\n            note: 0,\n            lineStaff: false,\n            // gives line on the cell if true -------------------------------\n            clickable: true,\n            // cell will unclicable if enabler is false ----------------------\n            select: true,\n            selectColumn: false,\n            starting: false,\n            firstRow: false\n          });\n        }\n      } // set design\n\n\n      for (let i = 4; i < column - 7; i++) {\n        if (i === 4 || i === 6 || i === 8 || i === 10 || i === 12) {\n          row[currentIndex][i].lineStaff = true;\n        }\n      }\n\n      if (kind === 4) {\n        this.incrementX();\n      }\n\n      if (row[currentIndex - 1][0].starting === true) {\n        for (let i = 0; i <= column - 1; i++) {\n          row[currentIndex][i].firstRow = true;\n        }\n      }\n\n      if (kind === 4) {\n        for (let i = 0; i <= column - 1; i++) {\n          row[currentIndex + 1][i].firstRow = false;\n        }\n      } // Make enabler true for the first column--------------SET DEFAULT---------------------------------\n\n\n      this.increment();\n      this.setState({\n        row\n      });\n    };\n\n    this.insertStartingMeasure = cell => {\n      let x = this.state.currentSelected;\n      let row = this.state.row;\n\n      if (row[x][0].starting === true) {\n        console.log(\"This is already a starting measure\");\n        return;\n      }\n\n      if (row[x - 1][0].starting === true) {\n        if (x === row.length) {\n          console.log(\"Unable to Insert Another Starting Just next to Starting\");\n          return;\n        }\n\n        if (row.length !== x + 1) {\n          if (row[x + 1][0].starting === true) {\n            console.log(\"Unable to Insert Another Starting Just next to Starting\");\n            return;\n          }\n        }\n      }\n\n      if (x !== 0) {\n        console.log(x, row);\n        row.splice(x, 0, []);\n        row[x].push({\n          x: x,\n          starting: true,\n          clef: null,\n          // Time signature\n          up: null,\n          down: null,\n          // Key signature\n          keySig: null,\n          selectColumn: false,\n          barLength: null,\n          accidental: \"#\",\n          mx: 0,\n          my: 0,\n          accLocation: []\n        });\n        console.log(row[x]);\n\n        for (let i = 0; i < 7; i++) {\n          row[x][0].accLocation.push([]);\n\n          for (let y = 0; y < 12; y++) {\n            row[x][0].accLocation[i].push({\n              my: false,\n              acc: \"\",\n              letter: \"\"\n            });\n          }\n        }\n\n        this.increment();\n        row[x + 1][0].selectColumn = false;\n        console.log(row[x][0]);\n        row[x][0].selectColumn = true;\n        row[x + 1][8].barline = false;\n        this.setState({\n          row,\n          currentSelected: x\n        });\n        this.props.viewOptionOn();\n        console.log(this.state.row);\n        this.incrementX();\n        let kind = 3;\n        let rowX = null;\n        let measure = 1;\n        console.log(x);\n\n        for (let a = x - 1; a >= 1; a--) {\n          console.log(a - 1, row[a - 1][0]);\n\n          if (row[a - 1][0].starting === true) {\n            measure = row[a][8].measure + 1;\n            break;\n          }\n\n          if (row[a][8].barline === true) {\n            measure = row[a][8].measure + 1;\n            break;\n          }\n        }\n\n        row[x + 1][8].measure = measure;\n        this.setMeasureNum(x + 1, rowX, kind);\n\n        for (let i = 0; i <= this.state.column - 1; i++) {\n          row[x + 1][i].firstRow = true;\n        }\n\n        if (row[x + 1][0].note > 0) {\n          let kind = 7;\n          this.checkStartingClef(x, rowX, kind);\n        }\n      } else {\n        console.log(\"already set\");\n      }\n\n      console.log(this.state.row);\n    };\n\n    this.removeStartingMeasure = cell => {\n      let row = this.state.row;\n      let x = this.state.currentSelected;\n\n      if (x === 0) {\n        console.log(\"Cannot Delete The First Starting Measure\");\n        return;\n      }\n\n      row.splice(x, 1);\n      this.decrementX();\n      row[x][8].barline = true;\n\n      for (let i = 0; i <= this.state.column - 1; i++) {\n        row[x][i].firstRow = false;\n      }\n\n      this.setState({\n        row\n      });\n      console.log(x, this.state.row);\n    };\n\n    this.incrementX = cell => {\n      let x = this.state.currentSelected + 1;\n      let row = this.state.row;\n      let column = this.state.column;\n      let rowLength = row.length;\n      console.log(x);\n\n      if (x === row.length - 1) {\n        return;\n      }\n\n      for (let a = x; a < rowLength; a++) {\n        if (row[a][0].starting === false) {\n          for (let i = 0; i < column; i++) {\n            row[a][i].x = a;\n          }\n        } else {\n          row[a][0].x = a;\n        }\n      }\n\n      this.setState({\n        row\n      });\n    };\n\n    this.decrementX = cell => {\n      let x = this.state.currentSelected;\n      let row = this.state.row;\n      let column = this.state.column;\n      let rowLength = row.length;\n\n      for (let a = x; a < rowLength; a++) {\n        if (row[a][0].starting === false) {\n          for (let i = 0; i < column; i++) {\n            row[a][i].x = a;\n          }\n        } else {\n          row[a][0].x = a;\n        }\n      }\n\n      this.setState({\n        row\n      }); // console.log(rowLength)\n    };\n\n    this.clickLeft = cell => {\n      console.log(\"Clicked left\");\n\n      if (this.props.handle === 1) {\n        let row = this.state.row;\n        let rowX = cell.x;\n        let kind = 4;\n        let measure = row[cell.x][8].measure;\n        row[cell.x][8].measure = null;\n        this.createRow(cell, rowX, kind);\n        row[cell.x - 1][8].measure = measure;\n        row[cell.x - 1][cell.y].isOpen = true;\n        row[cell.x - 1][cell.y].rest = this.props.rest;\n\n        for (let i = 0; i <= this.state.column - 1; i++) {\n          row[cell.x - 1][i].note = this.props.note;\n        }\n\n        let x = cell.x;\n        kind = 6;\n        this.findStartingMeasure(x, kind);\n        this.setState({\n          row\n        });\n      }\n\n      if (this.props.handle === 2) {\n        console.log(\"Clicked left handle 2\");\n\n        if (this.state.row[cell.x - 1][0].starting === true) {\n          // THIS IS STARTING, CAN'T CLICK\n          console.log(\"this is starting measure\");\n          return;\n        }\n\n        let swt = true;\n        this.props.insertStartingMeasureDisabler(swt);\n        this.handle2(cell + 1); // bar\n      }\n    };\n\n    this.clickRight = cell => {\n      console.log(\"Clicked Right\", cell.x + 1);\n      let row = this.state.row;\n\n      if (this.props.handle === 0) {\n        if (cell.x + 1 !== row.length) {\n          console.log(\"Clicked left handle 2\");\n          let kind = 5;\n          let side = cell.x + 1;\n          this.handle0(cell, kind, side); // bar\n        }\n      }\n\n      if (this.props.handle === 1) {\n        let rowX = cell.x + 1;\n        this.createRow(cell, rowX);\n        row[cell.x + 1][cell.y].isOpen = true;\n        row[cell.x + 1][cell.y].rest = this.props.rest;\n\n        for (let i = 0; i <= this.state.column - 1; i++) {\n          row[cell.x + 1][i].note = this.props.note;\n        }\n\n        this.incrementX(cell);\n        this.setState({\n          row\n        });\n        let x = cell.x;\n        let kind = 6;\n        this.findStartingMeasure(x, kind);\n      }\n\n      if (this.props.handle === 2) {\n        let swt = true;\n        let kind = 5;\n        let side = cell.x + 1;\n        this.props.insertStartingMeasureDisabler(swt);\n        this.handle2(cell, kind, side); // bar\n      }\n    };\n\n    this.click = (cell, kind, mx, my) => {\n      let row = this.state.row;\n      let handle = this.props.handle;\n\n      if (handle === 0) {\n        let swt = false;\n        this.props.insertStartingMeasureDisabler(swt);\n        let side;\n        this.handle0(cell, kind, side, mx, my); // select\n      }\n\n      if (handle === 1) {\n        let swt = true;\n        this.props.insertStartingMeasureDisabler(swt);\n        this.handle1(cell); // notes\n      }\n\n      if (handle === 2) {\n        let swt = true;\n        this.props.insertStartingMeasureDisabler(swt);\n        this.handle2(cell); // bar\n      }\n\n      this.setState({\n        row\n      });\n    };\n\n    this.handle0 = (cell, kind, side, mx, my) => {\n      let row = this.state.row;\n      let xValue = cell.x;\n\n      if (kind === 5) {\n        xValue = side;\n      }\n\n      let currentSelected = this.state.currentSelected;\n      row[currentSelected][0].selectColumn = false;\n      row[xValue][0].selectColumn = true;\n\n      if (row[xValue][0].starting === true) {\n        this.props.viewOptionOn();\n      } else {\n        this.props.viewOptionOff();\n      }\n\n      this.setState({\n        x: xValue,\n        currentSelected: xValue\n      });\n\n      if (kind === 8) {\n        this.ks1(cell, xValue, mx, my);\n      }\n    };\n\n    this.handle1 = cell => {\n      // contain conlose -------------- passing------------\n      let row = this.state.row;\n      let currentCell = row[cell.x][cell.y]; // get x and y positions\n\n      let x = cell.x;\n      let note = this.props.note;\n      console.log(this.props);\n\n      if (row[x][0].starting === false) {\n        if (currentCell.isOpen === false) {\n          // 1. Find if one of the cells in current row has a True value for isOpen\n          let found = row[x].findIndex(cell => {\n            if (cell.isOpen === true) return true;else {\n              return false;\n            }\n          }); // 2. deside if it is going to make another row next to it or not.\n\n          if (found === -1 && row.length - 1 === x) {\n            // if none\n            this.setState({\n              currentIndex: x\n            }); // this.createRow(); -----------------------------------------------------------------------------------\n          }\n\n          if (cell.x === 1) {\n            row[1][8].measure = 1;\n          }\n\n          currentCell.isOpen = true;\n          console.log(this.props.rest, currentCell.rest);\n          currentCell.rest = this.props.rest;\n          currentCell.note = note;\n          let kind = 6;\n          console.log(\"find Starting Measure\");\n          this.findStartingMeasure(x, kind); //the length of the note should be equal to it's column\n\n          row[x].findIndex(cell => {\n            cell.note = note;\n            return null;\n          });\n        } else {\n          // When Closing ------------------\n          currentCell.isOpen = false;\n          console.log(\"this will be CLOSE\");\n          let found = row[x].findIndex(cell => {\n            // find if there is true in isOpen from the specific row clicked\n            if (cell.isOpen === true) return true;else {\n              return false;\n            }\n          });\n\n          if (found === -1) {\n            console.log(x);\n\n            if (x !== 1) {\n              if (x + 1 !== row.length) {\n                if (row[x][8].barline === true) {\n                  // if x has barline but to be removes, put it in the next x\n                  if (row[x + 1][8].barline === false) {\n                    row[x + 1][8].barline = true;\n                    row[x + 1][8].measure = row[x][8].measure;\n                    row.splice(x, 1);\n                    this.decrementX(cell);\n                  } else {\n                    let a = 0;\n\n                    while (a <= this.state.column - 1) {\n                      row[x][a].note = 0;\n                      a++;\n                    }\n\n                    let type = 1;\n                    let error = 0;\n                    let measure = row[x][8].measure;\n                    this.props.consoleWarningTS(type, measure, error);\n                  }\n                } else {\n                  row.splice(x, 1);\n                  this.decrementX(cell);\n                  return;\n                }\n              }\n            }\n          }\n        }\n\n        this.setState({\n          x: x\n        });\n      } else {\n        console.log(\"this is a starting measure\");\n      }\n    };\n\n    this.handle2 = (cell, kind, side) => {\n      // create barline--------------- passing function with console\n      let x = cell.x;\n\n      if (kind === 5) {\n        x = side;\n      }\n\n      let row = this.state.row;\n      console.log(x, row.length);\n\n      if (x === row.length) {\n        console.log(\"This is the last row last. Use End Bar line\");\n        return;\n      }\n\n      if (x === 0 || row[x][0].starting === true) {\n        // THIS IS STARTING, CAN'T CLICK\n        console.log(\"this is starting measure\");\n      } else {\n        if (row[x - 1][0].starting === false) {\n          if (row[x - 1][0].barline === true) {\n            console.log(\"error: declaring barline without notes or rest between barlines\");\n          } else {\n            if (row[x][8].barline === false) {\n              //---- switch barline to TRUE\n              row[x][8].barline = true;\n              let kind = 1;\n              console.log(kind);\n              this.setState({\n                row\n              });\n              this.findStartingMeasure(x, kind); //  ------  findStartingMeasure => checkingStartingTS => console => setMeasureNum => measureLengthCalc\n            } else {\n              // ----------------switch barline to FALSE\n              row[x][8].barline = false;\n              row[x][8].measure = null;\n              let kind = 2;\n              this.setState({\n                row\n              });\n              this.findStartingMeasure(x, kind); //    ------  findStartingMeasure => checkingStartingTS => toLastNewMeasure => measureLengthCalc\n\n              let rowX;\n              this.setMeasureNum(x, rowX, kind);\n              let measure = 1;\n\n              for (let a = row.length - 1; a >= 1; a--) {\n                console.log(a, row[a][8].measure);\n\n                if (row[a][8].measure !== null) {\n                  console.log(row[a][8]);\n                  measure = row[a][8].measure + 1;\n                  break;\n                }\n              }\n\n              this.props.recalcuConsoleMeasure(measure);\n            }\n          }\n        }\n      }\n    };\n\n    this.setStarting = cell => {\n      // contain console ---------------------- passing function with console\n      let row = this.state.row;\n      let x = this.state.currentSelected;\n      row[x][0].clef = this.props.clef;\n      row[x][0].up = this.props.up;\n      row[x][0].down = this.props.down;\n      row[x][0].keySig = this.props.keySig; //-------FOR TS -----------------------------\n\n      if (row[x][0].up === null || row[x][0].down === null) {\n        console.log(\" TS not complete\");\n      } else {\n        //then\n        if (x === 0) {\n          row[x + 1][8].measure = 1;\n        }\n\n        let type = 3;\n        let error = 4;\n        let measure = row[x + 1][8].measure;\n        console.log(type, measure, error);\n        this.props.removeWarning(type, measure, error);\n        this.calcDownUp(x);\n        let rowX = x;\n        let kind = 1;\n        this.measureLengthCalc(x + 1, rowX, kind);\n      } //-------FOR Clef -----------------------------\n\n\n      if (row[x][0].Clef === null) {\n        console.log(\" clef not complete\");\n      } else {\n        let type = 4;\n        let error = 6;\n        let measure = row[x + 1][8].measure;\n        this.props.removeWarning(type, measure, error);\n        error = 7;\n        this.props.removeWarning(type, measure, error);\n        type = 5;\n        error = 11;\n        console.log(type, measure, error);\n        this.props.removeWarning(type, measure, error);\n        let currentSelected = x;\n        let kind = 8;\n        let mx = null;\n        let my = null;\n        this.ks2(cell, currentSelected, mx, my, kind);\n        row[x][0].keySig = \"C\";\n      }\n\n      this.setState({\n        row\n      });\n\n      for (x = 0; x < row.length - 1; x++) {\n        if (row[x][0].starting === true) {\n          let clef = row[x][0].clef;\n          let up = row[x][0].up;\n          let down = row[x][0].down;\n          let keySig = row[x][0].keySig;\n          console.log(row[x][0], clef, up, down, keySig);\n        }\n      }\n    };\n\n    this.findStartingMeasure = (x, kind) => {\n      console.log(x, kind, \"Get Starting Position's X axis\");\n      let row = this.state.row;\n      let rowX = 0; //  row[X] Position -------------\n\n      for (let i = x; i >= 0; i--) {\n        // find Starting\n        if (row[i][0].starting === true) {\n          rowX = i;\n          break;\n        }\n      } // -------------------------TS-----------------------------------\n\n\n      if (kind === 1) {\n        let kind = 1;\n        this.checkingStartingTS(x, rowX, kind);\n      }\n\n      if (kind === 2) {\n        let kind = 2;\n        this.toLastNewMeasure(x, rowX, kind);\n        this.measureLengthCalc(x, rowX, kind);\n      } // -------------------------KS-----------------------------------\n\n\n      if (kind === 6) {\n        let kind = 6;\n        this.checkStartingClef(x, rowX, kind);\n      }\n    };\n\n    this.toLastNewMeasure = (x, rowX, kind) => {\n      console.log(\"Get last clicable position's X axis\");\n      let row = this.state.row;\n\n      if (kind === 2) {\n        let barCount = 0;\n\n        for (let a = rowX; a <= row.length - 2; a++) {\n          if (row[a + 1][0].starting === false) {\n            if (row[a + 1][8].barline === true) {\n              barCount = barCount + 1;\n              console.log(row[a + 1][0].starting);\n            }\n          }\n        }\n\n        if (barCount === 0) {\n          let measure = row[rowX + 1][8].measure;\n          let type = 3;\n          let error = 4;\n          console.log(type, error, measure, row[rowX + 1][8].measure);\n          this.props.removeWarning(type, measure, error);\n        }\n\n        console.log(\"barcount =\", barCount);\n      }\n    };\n\n    this.checkingStartingTS = (x, rowX, kind) => {\n      console.log(x, rowX, \"Get Starting first measure's from left axis\");\n      let row = this.state.row;\n\n      if (kind === 1) {\n        let bLValrow = row[rowX][0].barLength;\n        let measure = row[rowX + 1][8].measure;\n        let type = 3;\n        let error = 4;\n\n        if (bLValrow === null) {\n          // Adding barline without declaring time signature for starting measure\n          let kind = 1;\n          console.log(type, error, measure, row[rowX + 1][8].measure);\n          this.setMeasureNum(x, rowX, kind); // --------------------measure numbers-----------\n\n          let up = row[rowX][0].up;\n          let down = row[rowX][0].down;\n          let barLength = row[rowX][0].barLength;\n          let totalNoteValue = row[rowX][0].totalNoteValue;\n          this.props.consoleWarningTS(type, measure, error, up, down, barLength, totalNoteValue);\n        } else {\n          // -----------------------if Up and Down are not Null\n          let kind = 1;\n          this.setMeasureNum(x, rowX, kind); // --------------------measure numbers-----------\n\n          console.log(\"hhh\");\n          this.measureLengthCalc(x, rowX, kind); //--------  proceed checking left and right measure\n        }\n      }\n\n      if (kind === 2) {\n        console.log(\"remove\");\n      }\n    };\n\n    this.setMeasureNum = (x, rowX, kind) => {\n      // set Measure Number\n      console.log(x, rowX, kind, \"Measure number or address\");\n      let row = this.state.row;\n      let measure = 1;\n      let kindHandler = 1;\n\n      if (kind === 3) {\n        kindHandler = 2;\n      }\n\n      for (let a = x - kindHandler; a >= 0; a--) {\n        if (a !== 0) {\n          if (row[a - 1][0].starting === true) {\n            measure = row[a][8].measure;\n            break;\n          }\n\n          if (row[a][8].barline === true) {\n            measure = row[a][8].measure;\n            break;\n          }\n        }\n      }\n\n      if (kind === 1) {\n        row[x][8].measure = measure + 1; // ------declare current measure number\n\n        measure = measure + 1;\n      }\n\n      if (kind === 3) {\n        measure = row[x][8].measure;\n      }\n\n      for (let b = x + 1; b <= row.length - 1; b++) {\n        if (row[b][0].starting === true) {\n          console.log(row[b + 1][8]);\n          row[b + 1][8].measure = measure + 1;\n          measure = measure + 1;\n          continue;\n        }\n\n        if (row[b][8].barline === true) {\n          row[b][8].measure = measure + 1;\n          measure = measure + 1;\n          continue;\n        }\n      }\n    };\n\n    this.measureLengthCalc = (x, rowX, kind) => {\n      // ------- get measure length   --- if kind 1, get measure length of left measure and right measure\n      let row = this.state.row;\n      let starting = x - 1;\n      let barLength = 0;\n      let newX = 1;\n      let measure = 1;\n      let loop = 1;\n      let up = null;\n      let down = null;\n      console.log(rowX, row[rowX]);\n      console.log(this.state.row);\n      barLength = row[rowX][0].barLength;\n      up = row[rowX][0].up;\n      down = row[rowX][0].down;\n\n      if (kind === 1) {\n        // if kind 1, need to do 2 loops\n        loop = row.length;\n      }\n\n      if (kind === 2) {\n        // if kind 1, need to do 2 loops\n        loop = row.length;\n      }\n\n      console.log(loop);\n\n      for (let l = 1; l <= loop; l++) {\n        // this is the loop       ------------ LOOP ------------\n        for (let n = starting; n >= 0; n--) {\n          // set the barLength\n          if (row[n][0].starting === true) {\n            barLength = row[n][0].barLength;\n            break;\n          }\n        }\n\n        console.log(\"loop number=\", l, \"Bar Length=\", barLength);\n\n        for (let n = starting; n >= 0; n--) {\n          // set the Strting POINT (newX) and measure   --- or The 1st column in  measure\n          if (row[n][0].starting === true) {\n            newX = n + 1;\n            measure = row[n + 1][8].measure;\n            break;\n          }\n\n          if (row[n][8].barline === true) {\n            newX = n;\n            measure = row[n][8].measure;\n            break;\n          }\n        }\n\n        console.log(x, starting, kind, \"Measure length Calc\", \"newX =\", newX, \"Measure=\", measure); //--------------------------------------------------\n\n        let ret = false;\n        let noteValue = [0]; // added Zero for reduce()\n\n        let nS = 0;\n        let nM = 0;\n        let nBL = barLength;\n\n        for (let b = newX; b <= row.length - 1; b++) {\n          if (row[b][0].starting === true) {\n            // break to the starting measure or a bar line\n            nS = b + 1;\n            nM = row[b + 1][8].measure;\n            console.log(row[b][0].barLength);\n            console.log(row[b][8], newX);\n            nBL = row[b][0].barLength;\n\n            if (row[b][0].barLength === null) {\n              // if the next starting measure's Time Siganture is NULL consoleWarn\n              for (let c = b; c <= row.length; c++) {\n                let type = 3;\n                let error = 4;\n                let measure = row[c][0].measure;\n                let up = row[c][0].up;\n                let barLength = row[c][0].barLength;\n                let down = row[c][0].down;\n                let totalNoteValue = row[rowX][0].totalNoteValue;\n                console.log(measure);\n\n                if (row[c][0].starting === true) {\n                  this.props.consoleWarningTS(type, measure, error, up, down, barLength, totalNoteValue);\n                } else {\n                  b = c;\n                  break;\n                }\n              }\n            }\n\n            break;\n          }\n\n          if (row[b][8].barline === true) {\n            nS = b;\n            nM = row[b][8].measure;\n            console.log(row[b][8], newX);\n\n            if (b !== newX) {\n              break;\n            }\n          }\n\n          if (row[b][0].note === 1) {\n            noteValue.push(4);\n          }\n\n          if (row[b][0].note === 2) {\n            noteValue.push(2);\n          }\n\n          if (row[b][0].note === 4) {\n            noteValue.push(1);\n          }\n\n          if (b === row.length - 1) {\n            ret = true;\n          }\n        }\n\n        let totalNoteValue = noteValue.reduce((accumulator, currentValue) => {\n          return accumulator + currentValue;\n        });\n        console.log(measure, barLength, \"vs\", totalNoteValue); // -------------------------\n\n        let type = 1;\n        console.log(barLength, totalNoteValue, kind);\n\n        if (barLength === null) {\n          starting = nS;\n          measure = nM;\n          barLength = nBL;\n          console.log(starting, measure, barLength);\n\n          if (ret === true) {\n            console.log(\"Done\");\n            return;\n          }\n\n          continue;\n        }\n\n        if (barLength > totalNoteValue) {\n          let error = 1;\n          this.props.consoleWarningTS(type, measure, error, up, down, barLength, totalNoteValue);\n          console.log(\"kulang\");\n        }\n\n        if (barLength < totalNoteValue) {\n          let error = 2;\n          this.props.consoleWarningTS(type, measure, error, up, down, barLength, totalNoteValue);\n          console.log(\"sobra\");\n        }\n\n        if (barLength === totalNoteValue) {\n          console.log(\"chakto\");\n          this.props.removeWarning(type, measure);\n        } // measure = nextMeasure\n        // barLength = nextBarLength\n\n\n        starting = nS;\n        measure = nM;\n        barLength = nBL;\n        console.log(starting, measure, barLength);\n\n        if (ret === true) {\n          console.log(\"Done\");\n          return;\n        }\n      }\n    };\n\n    this.calcDownUp = x => {\n      let row = this.state.row;\n      let up = this.props.up;\n      let down = this.props.down;\n      let calcDown = 0;\n      let c = 4;\n      let i = 0;\n      console.log(up, down);\n\n      while (calcDown !== 4 || i < 7) {\n        //current note value should be 4 && do while for 7 times only, limit to 7\n        calcDown = c * down;\n\n        if (calcDown !== 4) {\n          c = c / 2;\n        } else {\n          break;\n        }\n\n        i++;\n      }\n\n      let barLength = c * up;\n      console.log(barLength);\n      row[x][0].barLength = barLength;\n      this.setState({\n        row\n      });\n    };\n\n    this.valuePerMeasureCalc = (cell, h, x, m) => {\n      // contain console\n      console.log(\"valuePerMeasureCalc\", cell, h, x, m);\n      let row = this.state.row;\n      let currentX = 0;\n      let starting = 0;\n      let barline = 1;\n      let startingMeasure = 0; //--- THIS IS THE MEASURE\n\n      for (let i = currentX; i >= 1; i--) {\n        // find Starting Measure\n        if (row[i][0].starting === false) {\n          if (row[i][8].barline === true) {\n            // if found...\n            barline = i;\n            break;\n          } else {\n            continue;\n          }\n        } else {\n          barline = i + 1;\n          break;\n        }\n      }\n\n      startingMeasure = row[barline][8].measure;\n      let measure = startingMeasure;\n      console.log(m); //------------------------------------------------------------------------------------------------------------\n\n      let noteValue = [0]; // added Zero for reduce()\n\n      for (let i = barline; i <= row.length - 1 || row[i - 1][0].starting === true || row[i - 1][8].barline === true; i++) {\n        // find end of Measure\n        console.log(barline, measure);\n\n        if (row[i][0].starting === false) {\n          if (row[i][8].barline === false) {\n            if (row[i][0].note === 1) {\n              console.log(\"pushed 4\");\n              noteValue.push(4);\n            }\n\n            if (row[i][0].note === 2) {\n              console.log(\"pushed 2\");\n              noteValue.push(2);\n            }\n\n            if (row[i][0].note === 4) {\n              console.log(\"pushed 1\");\n              noteValue.push(1);\n            }\n          } else {\n            break;\n          }\n        } else {\n          break;\n        }\n      }\n\n      console.log(noteValue);\n      let barLength = row[starting][0].barLength;\n      let totalNoteValue = noteValue.reduce((accumulator, currentValue) => {\n        return accumulator + currentValue;\n      });\n      console.log(startingMeasure, barLength, \"vs\", totalNoteValue);\n      let type = 1;\n      let up = row[starting][0].up;\n      let down = row[starting][0].down;\n\n      if (barLength > totalNoteValue) {\n        let error = 1;\n        this.props.consoleWarningTS(type, measure, error, up, down);\n        console.log(\"kulang\");\n        return;\n      }\n\n      if (barLength < totalNoteValue) {\n        let error = 2;\n        this.props.consoleWarningTS(type, measure, error, up, down);\n        console.log(\"sobra\");\n        return;\n      }\n\n      if (barLength === totalNoteValue) {\n        console.log(h, m);\n        console.log(\"chakto\");\n        this.props.removeWarning(type, measure, up, down);\n        return;\n      }\n\n      console.log(currentX, starting, barline, barLength, totalNoteValue, startingMeasure);\n    };\n\n    this.checkStartingClef = (x, rowX, kind) => {\n      let row = this.state.row;\n      let a = null;\n\n      if (kind === 6) {\n        a = rowX;\n      }\n\n      if (kind === 7) {\n        a = x;\n      }\n\n      console.log(row[a][0]);\n\n      if (row[a][0].clef === null) {\n        let type = 4;\n        let measure = row[a + 1][8].measure;\n        let error = 6;\n        this.props.consoleWarningClef(type, measure, error);\n      } else {\n        this.measureLengthCalc(x, rowX, kind);\n      }\n    };\n\n    this.insertStartingMeasure = this.insertStartingMeasure.bind(this);\n    this.setStarting = this.setStarting.bind(this);\n    this.removeStartingMeasure = this.removeStartingMeasure.bind(this);\n    this.state = {\n      currentIndex: 1,\n      row: [[]],\n      column: 20,\n      currentSelected: 0,\n      x: 0,\n      clef: 10,\n      // 10 = G-clef,\n      accidental: \"#\",\n      barLength: null,\n      measureLengthCalc: [],\n      buttonBool: true\n    };\n  }\n\n  createMeasureRow() {\n    let row = this.state.row;\n    row.splice(0, 1, []);\n    row[0].push({\n      x: 0,\n      starting: true,\n      clef: null,\n      // Time signature\n      up: null,\n      down: null,\n      // Key signature\n      keySig: null,\n      selectColumn: false,\n      barLength: null,\n      accidental: \"#\",\n      mx: 0,\n      my: 0,\n      letter: \"\",\n      accLocation: []\n    });\n    console.log(row[0]);\n\n    for (let i = 0; i < 7; i++) {\n      row[0][0].accLocation.push([]);\n\n      for (let y = 0; y < 12; y++) {\n        row[0][0].accLocation[i].push({\n          my: false,\n          acc: \"\",\n          letter: \"\"\n        });\n      }\n    } // set design\n    // Make enabler true for the first column--------------SET DEFAULT---------------------------------\n\n\n    this.setState({\n      row\n    });\n  }\n\n  increment() {\n    this.setState({\n      currentIndex: this.state.currentIndex + 1\n    });\n  }\n\n  decrement() {\n    this.setState({\n      currentIndex: this.state.currentIndex - 1\n    });\n  }\n\n  //----------------------------------------------------------------------------------------------------------------------------------------------\n  componentDidMount() {\n    this.createMeasureRow();\n    this.createRow();\n    this.measure1();\n    this.props.insertStartingMeasure(this.insertStartingMeasure);\n    this.props.setStarting(this.setStarting);\n    this.props.removeStartingMeasure(this.removeStartingMeasure);\n  }\n\n  measure1() {\n    let row = this.state.row;\n    row[1][8].measure = 1;\n    this.setState({\n      row\n    });\n  } //-----------------------------RENDER HERE------------------------------------\n\n\n  render() {\n    let rows = this.state.row.map((row, index) => {\n      return /*#__PURE__*/_jsxDEV(Row, {\n        cells: row,\n        click: this.click,\n        clickLeft: this.clickLeft,\n        clickRight: this.clickRight,\n        ks1: this.ks1,\n        ks2: this.ks2\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1474,\n        columnNumber: 9\n      }, this);\n    });\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(Timer, {\n          row: this.state.row,\n          column: this.state.column,\n          tempo: this.props.tempo,\n          timeSig: this.props.timeSig,\n          currentSelected: this.state.currentSelected,\n          startPauseSwitch: this.props.startPauseSwitch,\n          clockStop: this.props.clockStop,\n          volume: this.props.volume,\n          playerIcon: this.props.playerIcon,\n          consoleWarningClef: this.props.consoleWarningClef,\n          metronome: this.props.metronome\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1488,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1487,\n        columnNumber: 9\n      }, this), rows]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1486,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Board;","map":{"version":3,"sources":["C:/Users/Raivex/Desktop/THESIS/musimu/gui/src/simulator/Board.js"],"names":["React","Component","Row","Timer","Board","constructor","props","ks1","cell","xValue","mx","my","handle","currentSelected","row","state","accidental","setState","ks2","kind","type","console","log","undefined","starting","accLocation","acc","a","current","push","b","currentNext","length","x","y","xDup","c","xCount","i","error","measure","consoleWarningKS","removeWarning","yDup","yCount","mixed","clef","keySignatureClefCompare","letter","picker","round","alpMap","keySeq","addUp","sequence","keySig","createRow","rowX","currentIndex","column","splice","isOpen","rest","note","lineStaff","clickable","firstRow","barline","select","selectColumn","incrementX","increment","insertStartingMeasure","up","down","barLength","viewOptionOn","setMeasureNum","checkStartingClef","removeStartingMeasure","decrementX","rowLength","clickLeft","findStartingMeasure","swt","insertStartingMeasureDisabler","handle2","clickRight","side","handle0","click","handle1","viewOptionOff","currentCell","found","findIndex","consoleWarningTS","recalcuConsoleMeasure","setStarting","calcDownUp","measureLengthCalc","Clef","checkingStartingTS","toLastNewMeasure","barCount","bLValrow","totalNoteValue","kindHandler","newX","loop","l","n","ret","noteValue","nS","nM","nBL","reduce","accumulator","currentValue","calcDown","valuePerMeasureCalc","h","m","currentX","startingMeasure","consoleWarningClef","bind","buttonBool","createMeasureRow","decrement","componentDidMount","measure1","render","rows","map","index","tempo","timeSig","startPauseSwitch","clockStop","volume","playerIcon","metronome"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Row from \"./Row\";\r\nimport Timer from \"./Timer\";\r\n\r\nclass Board extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.insertStartingMeasure = this.insertStartingMeasure.bind(this);\r\n    this.setStarting = this.setStarting.bind(this);\r\n    this.removeStartingMeasure = this.removeStartingMeasure.bind(this);\r\n\r\n    this.state = {\r\n      currentIndex: 1,\r\n      row: [[]],\r\n      column: 20,\r\n      currentSelected: 0,\r\n      x: 0,\r\n\r\n      clef: 10, // 10 = G-clef,\r\n      accidental: \"#\",\r\n      barLength: null,\r\n      measureLengthCalc: [],\r\n\r\n      buttonBool: true,\r\n    };\r\n  }\r\n\r\n  ks1 = (cell, xValue, mx, my) => {\r\n    if (this.props.handle === 0) {\r\n      let currentSelected = xValue;\r\n      let row = this.state.row;\r\n      row[currentSelected][0].accidental = this.props.accidental;\r\n      this.setState({ row });\r\n      this.ks2(cell, currentSelected, mx, my);\r\n    }\r\n  };\r\n  ks2 = (cell, currentSelected, mx, my, kind) => {\r\n    let type = 5;\r\n    let row = this.state.row;\r\n    console.log(row[currentSelected][0]);\r\n    if (this.props.handle === 0) {\r\n      if (kind === undefined) {\r\n        if (row[currentSelected][0].starting !== true) {\r\n          return;\r\n        } // --------------debuged--------------------\r\n        //all y in x ---- means -----  check column\r\n\r\n        if (row[currentSelected][0].accLocation[mx][my].my === false) {\r\n          row[currentSelected][0].accLocation[mx][my].my = true;\r\n          row[currentSelected][0].accLocation[mx][my].acc =\r\n            row[currentSelected][0].accidental;\r\n          row[currentSelected][0].accLocation[mx][11].my = true;\r\n        } else {\r\n          let a = 0;\r\n          let current = [];\r\n          while (a < 9) {\r\n            if (\r\n              row[currentSelected][0].accLocation[mx][a].my === true &&\r\n              my !== a\r\n            ) {\r\n              current.push(a);\r\n            }\r\n            a++;\r\n            if (a === 9) {\r\n              a = 0;\r\n              break;\r\n            }\r\n          }\r\n          let b = 0;\r\n          let currentNext = [];\r\n          if (mx !== 6) {\r\n            while (b < 9) {\r\n              if (row[currentSelected][0].accLocation[mx + 1][b].my === true) {\r\n                currentNext.push(b);\r\n              }\r\n              b++;\r\n            }\r\n          }\r\n\r\n          if (mx === 6) {\r\n            row[currentSelected][0].accLocation[6][my].my = false;\r\n            console.log(\"a\");\r\n          }\r\n\r\n          if (current.length === 0 && currentNext.length === 0) {\r\n            row[currentSelected][0].accLocation[mx][my].my = false;\r\n            row[currentSelected][0].accLocation[mx][11].my = false;\r\n            console.log(\"b\");\r\n          }\r\n\r\n          if (current.length !== 0 && currentNext.length !== 0) {\r\n            row[currentSelected][0].accLocation[mx][my].my = false;\r\n            console.log(\"c\");\r\n          }\r\n          if (current.length !== 0 && currentNext.length === 0) {\r\n            row[currentSelected][0].accLocation[mx][my].my = false;\r\n            console.log(\"d\");\r\n          }\r\n        }\r\n      }\r\n      //--------------------------------------------------Checking-----------------------------------------\r\n      let a = [];\r\n      for (let x = 0; x <= 6; x++) {\r\n        let y = 0;\r\n        while (y < 10) {\r\n          if (row[currentSelected][0].accLocation[x][y].my === true) {\r\n            a.push({\r\n              acc: row[currentSelected][0].accLocation[x][y].acc,\r\n              x: x,\r\n              y: y,\r\n            });\r\n          }\r\n          y++;\r\n        }\r\n      }\r\n\r\n      let xDup = false;\r\n      for (let c = 0; c < a.length; c++) {\r\n        let xCount = [];\r\n        let i = 0;\r\n        while (i < a.length) {\r\n          if (a[i].x === c) {\r\n            xCount.push(c);\r\n          }\r\n          i++;\r\n        }\r\n        if (xCount.length === 0) {\r\n          break;\r\n        }\r\n        if (xCount.length > 1) {\r\n          xDup = true;\r\n          let error = 8;\r\n          let measure = row[currentSelected + 1][8].measure;\r\n          let accidental = row[currentSelected][0].accidental;\r\n          this.props.consoleWarningKS(type, measure, error, accidental, my, mx);\r\n        }\r\n        if (xDup === false) {\r\n          let error = 8;\r\n          let measure = row[currentSelected + 1][8].measure;\r\n          let accidental = row[currentSelected][0].accidental;\r\n          this.props.removeWarning(type, measure, error, accidental, my, mx);\r\n        }\r\n      }\r\n\r\n      // ------------------------for y ------------------------------------------------\r\n      let yDup = false;\r\n      let y = 0;\r\n      while (y < 10) {\r\n        let yCount = [];\r\n        for (let i = 0; i < a.length; i++) {\r\n          if (a[i].y === y) {\r\n            yCount.push(i);\r\n          }\r\n        }\r\n        if (yCount.length > 1) {\r\n          yDup = true;\r\n          // break;\r\n        }\r\n\r\n        y++;\r\n      }\r\n      if (yDup === true) {\r\n        let error = 9;\r\n        let measure = row[currentSelected + 1][8].measure;\r\n        let accidental = row[currentSelected][0].accidental;\r\n        this.props.consoleWarningKS(type, measure, error, accidental, my, mx);\r\n      } else {\r\n        let error = 9;\r\n        let measure = row[currentSelected + 1][8].measure;\r\n        let accidental = row[currentSelected][0].accidental;\r\n        this.props.removeWarning(type, measure, error, accidental, my, mx);\r\n      }\r\n\r\n      this.setState({ row });\r\n      // -------------------------------CHECKING IF THE ACCIDENTALS ARE THE SAME ----------------------------\r\n\r\n      let mixed = false;\r\n      for (let i = 0; i <= a.length - 1; i++) {\r\n        if (a[0].acc !== a[i].acc) {\r\n          mixed = true;\r\n          break;\r\n        }\r\n      }\r\n      if (mixed === true) {\r\n        console.log(\"different\");\r\n        let error = 10;\r\n        let measure = row[currentSelected + 1][8].measure;\r\n        let accidental = row[currentSelected][0].accidental;\r\n        this.props.consoleWarningKS(type, measure, error, accidental);\r\n      } else {\r\n        let error = 10;\r\n        let measure = row[currentSelected + 1][8].measure;\r\n        let accidental = row[currentSelected][0].accidental;\r\n        this.props.removeWarning(type, measure, error, accidental);\r\n      }\r\n\r\n      // ----------------------What Key Signature------------------------\r\n      if (row[currentSelected][0].clef === null) {\r\n        console.log(currentSelected, \"it's null\");\r\n        let error = 11;\r\n        let measure = row[currentSelected + 1][8].measure;\r\n        let accidental = row[currentSelected][0].accidental;\r\n        this.props.consoleWarningKS(type, measure, error, accidental);\r\n        return;\r\n      }\r\n      let clef = row[currentSelected][0].clef;\r\n      this.keySignatureClefCompare(clef, a, currentSelected);\r\n    } else {\r\n      console.log(\"Use Select tool to edit Key Signature\");\r\n    }\r\n  };\r\n  keySignatureClefCompare = (clef, a, currentSelected) => {\r\n    console.log(a);\r\n    // -----------set Letters --------------------------\r\n    let row = this.state.row;\r\n    let letter = [\"G\", \"F\", \"E\", \"D\", \"C\", \"B\", \"A\"];\r\n    let picker = 0;\r\n    let round = 0;\r\n    if (clef === \"G\") {\r\n      round = 0;\r\n      picker = 0;\r\n    }\r\n    if (clef === \"F\") {\r\n      round = 5;\r\n      picker = 5;\r\n    }\r\n\r\n    for (let x = 0; x < 7; x++) {\r\n      for (let y = 0; y < 12; y++) {\r\n        row[currentSelected][0].accLocation[x][y].letter = letter[picker];\r\n        picker++;\r\n        if (picker === 7) {\r\n          picker = 0;\r\n        }\r\n        if (y === 11) {\r\n          picker = round;\r\n        }\r\n      }\r\n    }\r\n    let alpMap = [\r\n      \"G\",\r\n      \"D\",\r\n      \"A\",\r\n      \"E\",\r\n      \"B\",\r\n      \"F#\",\r\n      \"C#\",\r\n      \"F\",\r\n      \"Bb\",\r\n      \"Eb\",\r\n      \"Ab\",\r\n      \"Db\",\r\n      \"Gb\",\r\n      \"Cb\",\r\n      \"C\",\r\n    ];\r\n    let keySeq = [\r\n      \"F\",\r\n      \"C\",\r\n      \"G\",\r\n      \"D\",\r\n      \"A\",\r\n      \"E\",\r\n      \"B\",\r\n      \"B\",\r\n      \"E\",\r\n      \"A\",\r\n      \"D\",\r\n      \"G\",\r\n      \"C\",\r\n      \"F\",\r\n    ];\r\n    let addUp = 0;\r\n    let sequence = [];\r\n\r\n    for (let i = 0; i < a.length; i++) {\r\n      console.log(\r\n        row[currentSelected][0].accLocation[a[i].x][a[i].y].letter,\r\n        a[i].acc\r\n      );\r\n      sequence.push({\r\n        letter: row[currentSelected][0].accLocation[a[i].x][a[i].y].letter,\r\n        acc: a[i].acc,\r\n      });\r\n    }\r\n\r\n    let type = 5;\r\n    let error = 12;\r\n    let measure = row[currentSelected + 1][8].measure;\r\n\r\n    if (sequence.length === 0) {\r\n      this.props.removeWarning(type, measure, error);\r\n    } else {\r\n      if (a[0].acc === \"b\") {\r\n        addUp = 7;\r\n      }\r\n      for (let i = 0; i < a.length; i++) {\r\n        if (sequence[i].letter === keySeq[i + addUp]) {\r\n          console.log(\r\n            sequence[i].letter,\r\n            keySeq[i + addUp],\r\n            \"Key of\",\r\n            alpMap[i + addUp]\r\n          );\r\n\r\n          if (i === a.length - 1) {\r\n            console.log(\r\n              sequence[i].letter,\r\n              keySeq[i],\r\n              \"Final Key is in Key of\",\r\n              alpMap[i + addUp]\r\n            );\r\n            this.props.removeWarning(type, measure, error);\r\n            row[currentSelected][0].keySig = alpMap[i + addUp];\r\n            break;\r\n          }\r\n        } else {\r\n          console.log(\"unkown Key Signature\");\r\n          this.props.consoleWarningKS(type, measure, error);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log(sequence, a.length);\r\n    console.log(a.length);\r\n    this.setState({ row });\r\n  };\r\n  createRow = (cell, rowX, kind) => {\r\n    // let currentIndex = this.state.currentIndex;\r\n\r\n    let currentIndex = null;\r\n    if (rowX !== undefined) {\r\n      currentIndex = rowX;\r\n    } else {\r\n      currentIndex = this.state.currentIndex;\r\n    }\r\n    let row = this.state.row;\r\n    let column = this.state.column;\r\n\r\n    row.splice(currentIndex, 0, []);\r\n    for (let y = 0; y < column; y++) {\r\n      if (y !== 0) {\r\n        if (y !== 8) {\r\n          row[currentIndex].push({\r\n            x: currentIndex,\r\n            y: y,\r\n\r\n            isOpen: false,\r\n            rest: false,\r\n            note: 0,\r\n            lineStaff: false, // gives line on the cell if true -------------------------------\r\n            clickable: true, // cell will unclicable if enabler is false ----------------------\r\n            starting: false,\r\n            firstRow: false,\r\n          });\r\n        } else {\r\n          row[currentIndex].push({\r\n            x: currentIndex,\r\n            y: y,\r\n\r\n            isOpen: false,\r\n            rest: false,\r\n            note: 0,\r\n            measure: null,\r\n            lineStaff: false, // gives line on the cell if true -------------------------------\r\n            clickable: true, // cell will unclicable if enabler is false ----------------------\r\n            barline: false,\r\n            starting: false,\r\n            firstRow: false,\r\n          });\r\n        }\r\n      } else {\r\n        row[currentIndex].push({\r\n          x: currentIndex,\r\n          y: y,\r\n\r\n          isOpen: false,\r\n          rest: false,\r\n\r\n          note: 0,\r\n          lineStaff: false, // gives line on the cell if true -------------------------------\r\n          clickable: true, // cell will unclicable if enabler is false ----------------------\r\n\r\n          select: true,\r\n\r\n          selectColumn: false,\r\n          starting: false,\r\n          firstRow: false,\r\n        });\r\n      }\r\n    }\r\n\r\n    // set design\r\n    for (let i = 4; i < column - 7; i++) {\r\n      if (i === 4 || i === 6 || i === 8 || i === 10 || i === 12) {\r\n        row[currentIndex][i].lineStaff = true;\r\n      }\r\n    }\r\n\r\n    if (kind === 4) {\r\n      this.incrementX();\r\n    }\r\n    if (row[currentIndex - 1][0].starting === true) {\r\n      for (let i = 0; i <= column - 1; i++) {\r\n        row[currentIndex][i].firstRow = true;\r\n      }\r\n    }\r\n    if (kind === 4) {\r\n      for (let i = 0; i <= column - 1; i++) {\r\n        row[currentIndex + 1][i].firstRow = false;\r\n      }\r\n    }\r\n\r\n    // Make enabler true for the first column--------------SET DEFAULT---------------------------------\r\n\r\n    this.increment();\r\n    this.setState({ row });\r\n  };\r\n  createMeasureRow() {\r\n    let row = this.state.row;\r\n\r\n    row.splice(0, 1, []);\r\n    row[0].push({\r\n      x: 0,\r\n      starting: true,\r\n\r\n      clef: null,\r\n\r\n      // Time signature\r\n\r\n      up: null,\r\n      down: null,\r\n      // Key signature\r\n      keySig: null,\r\n\r\n      selectColumn: false,\r\n      barLength: null,\r\n\r\n      accidental: \"#\",\r\n      mx: 0,\r\n      my: 0,\r\n      letter: \"\",\r\n      accLocation: [],\r\n    });\r\n    console.log(row[0]);\r\n    for (let i = 0; i < 7; i++) {\r\n      row[0][0].accLocation.push([]);\r\n      for (let y = 0; y < 12; y++) {\r\n        row[0][0].accLocation[i].push({\r\n          my: false,\r\n          acc: \"\",\r\n          letter: \"\",\r\n        });\r\n      }\r\n    }\r\n\r\n    // set design\r\n\r\n    // Make enabler true for the first column--------------SET DEFAULT---------------------------------\r\n\r\n    this.setState({ row });\r\n  }\r\n  insertStartingMeasure = (cell) => {\r\n    let x = this.state.currentSelected;\r\n    let row = this.state.row;\r\n\r\n    if (row[x][0].starting === true) {\r\n      console.log(\"This is already a starting measure\");\r\n      return;\r\n    }\r\n\r\n    if (row[x - 1][0].starting === true) {\r\n      if (x === row.length) {\r\n        console.log(\"Unable to Insert Another Starting Just next to Starting\");\r\n        return;\r\n      }\r\n      if (row.length !== x + 1) {\r\n        if (row[x + 1][0].starting === true) {\r\n          console.log(\r\n            \"Unable to Insert Another Starting Just next to Starting\"\r\n          );\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (x !== 0) {\r\n      console.log(x, row);\r\n      row.splice(x, 0, []);\r\n\r\n      row[x].push({\r\n        x: x,\r\n        starting: true,\r\n\r\n        clef: null,\r\n\r\n        // Time signature\r\n\r\n        up: null,\r\n        down: null,\r\n        // Key signature\r\n        keySig: null,\r\n\r\n        selectColumn: false,\r\n        barLength: null,\r\n\r\n        accidental: \"#\",\r\n        mx: 0,\r\n        my: 0,\r\n\r\n        accLocation: [],\r\n      });\r\n      console.log(row[x]);\r\n      for (let i = 0; i < 7; i++) {\r\n        row[x][0].accLocation.push([]);\r\n        for (let y = 0; y < 12; y++) {\r\n          row[x][0].accLocation[i].push({\r\n            my: false,\r\n            acc: \"\",\r\n            letter: \"\",\r\n          });\r\n        }\r\n      }\r\n\r\n      this.increment();\r\n\r\n      row[x + 1][0].selectColumn = false;\r\n      console.log(row[x][0]);\r\n      row[x][0].selectColumn = true;\r\n      row[x + 1][8].barline = false;\r\n\r\n      this.setState({\r\n        row,\r\n        currentSelected: x,\r\n      });\r\n      this.props.viewOptionOn();\r\n      console.log(this.state.row);\r\n      this.incrementX();\r\n\r\n      let kind = 3;\r\n      let rowX = null;\r\n      let measure = 1;\r\n      console.log(x);\r\n      for (let a = x - 1; a >= 1; a--) {\r\n        console.log(a - 1, row[a - 1][0]);\r\n        if (row[a - 1][0].starting === true) {\r\n          measure = row[a][8].measure + 1;\r\n          break;\r\n        }\r\n\r\n        if (row[a][8].barline === true) {\r\n          measure = row[a][8].measure + 1;\r\n          break;\r\n        }\r\n      }\r\n      row[x + 1][8].measure = measure;\r\n      this.setMeasureNum(x + 1, rowX, kind);\r\n\r\n      for (let i = 0; i <= this.state.column - 1; i++) {\r\n        row[x + 1][i].firstRow = true;\r\n      }\r\n\r\n      if (row[x + 1][0].note > 0) {\r\n        let kind = 7;\r\n        this.checkStartingClef(x, rowX, kind);\r\n      }\r\n    } else {\r\n      console.log(\"already set\");\r\n    }\r\n    console.log(this.state.row);\r\n  };\r\n  removeStartingMeasure = (cell) => {\r\n    let row = this.state.row;\r\n    let x = this.state.currentSelected;\r\n\r\n    if (x === 0) {\r\n      console.log(\"Cannot Delete The First Starting Measure\");\r\n      return;\r\n    }\r\n    row.splice(x, 1);\r\n\r\n    this.decrementX();\r\n    row[x][8].barline = true;\r\n\r\n    for (let i = 0; i <= this.state.column - 1; i++) {\r\n      row[x][i].firstRow = false;\r\n    }\r\n\r\n    this.setState({ row });\r\n    console.log(x, this.state.row);\r\n  };\r\n  increment() {\r\n    this.setState({\r\n      currentIndex: this.state.currentIndex + 1,\r\n    });\r\n  }\r\n  decrement() {\r\n    this.setState({\r\n      currentIndex: this.state.currentIndex - 1,\r\n    });\r\n  }\r\n  incrementX = (cell) => {\r\n    let x = this.state.currentSelected + 1;\r\n    let row = this.state.row;\r\n    let column = this.state.column;\r\n    let rowLength = row.length;\r\n    console.log(x);\r\n    if (x === row.length - 1) {\r\n      return;\r\n    }\r\n\r\n    for (let a = x; a < rowLength; a++) {\r\n      if (row[a][0].starting === false) {\r\n        for (let i = 0; i < column; i++) {\r\n          row[a][i].x = a;\r\n        }\r\n      } else {\r\n        row[a][0].x = a;\r\n      }\r\n    }\r\n    this.setState({ row });\r\n  };\r\n  decrementX = (cell) => {\r\n    let x = this.state.currentSelected;\r\n    let row = this.state.row;\r\n    let column = this.state.column;\r\n    let rowLength = row.length;\r\n\r\n    for (let a = x; a < rowLength; a++) {\r\n      if (row[a][0].starting === false) {\r\n        for (let i = 0; i < column; i++) {\r\n          row[a][i].x = a;\r\n        }\r\n      } else {\r\n        row[a][0].x = a;\r\n      }\r\n    }\r\n\r\n    this.setState({ row });\r\n\r\n    // console.log(rowLength)\r\n  };\r\n  clickLeft = (cell) => {\r\n    console.log(\"Clicked left\");\r\n\r\n    if (this.props.handle === 1) {\r\n      let row = this.state.row;\r\n      let rowX = cell.x;\r\n      let kind = 4;\r\n      let measure = row[cell.x][8].measure;\r\n\r\n      row[cell.x][8].measure = null;\r\n\r\n      this.createRow(cell, rowX, kind);\r\n\r\n      row[cell.x - 1][8].measure = measure;\r\n      row[cell.x - 1][cell.y].isOpen = true;\r\n      row[cell.x - 1][cell.y].rest = this.props.rest;\r\n      for (let i = 0; i <= this.state.column - 1; i++) {\r\n        row[cell.x - 1][i].note = this.props.note;\r\n      }\r\n      let x = cell.x;\r\n      kind = 6;\r\n      this.findStartingMeasure(x, kind);\r\n      this.setState({ row });\r\n    }\r\n\r\n    if (this.props.handle === 2) {\r\n      console.log(\"Clicked left handle 2\");\r\n      if (this.state.row[cell.x - 1][0].starting === true) {\r\n        // THIS IS STARTING, CAN'T CLICK\r\n        console.log(\"this is starting measure\");\r\n        return;\r\n      }\r\n      let swt = true;\r\n      this.props.insertStartingMeasureDisabler(swt);\r\n      this.handle2(cell + 1); // bar\r\n    }\r\n  };\r\n  clickRight = (cell) => {\r\n    console.log(\"Clicked Right\", cell.x + 1);\r\n\r\n    let row = this.state.row;\r\n    if (this.props.handle === 0) {\r\n      if (cell.x + 1 !== row.length) {\r\n        console.log(\"Clicked left handle 2\");\r\n        let kind = 5;\r\n        let side = cell.x + 1;\r\n        this.handle0(cell, kind, side); // bar\r\n      }\r\n    }\r\n    if (this.props.handle === 1) {\r\n      let rowX = cell.x + 1;\r\n\r\n      this.createRow(cell, rowX);\r\n\r\n      row[cell.x + 1][cell.y].isOpen = true;\r\n      row[cell.x + 1][cell.y].rest = this.props.rest;\r\n\r\n      for (let i = 0; i <= this.state.column - 1; i++) {\r\n        row[cell.x + 1][i].note = this.props.note;\r\n      }\r\n\r\n      this.incrementX(cell);\r\n      this.setState({ row });\r\n      let x = cell.x;\r\n      let kind = 6;\r\n      this.findStartingMeasure(x, kind);\r\n    }\r\n\r\n    if (this.props.handle === 2) {\r\n      let swt = true;\r\n      let kind = 5;\r\n      let side = cell.x + 1;\r\n      this.props.insertStartingMeasureDisabler(swt);\r\n      this.handle2(cell, kind, side); // bar\r\n    }\r\n  };\r\n  click = (cell, kind, mx, my) => {\r\n    let row = this.state.row;\r\n    let handle = this.props.handle;\r\n    if (handle === 0) {\r\n      let swt = false;\r\n      this.props.insertStartingMeasureDisabler(swt);\r\n      let side;\r\n      this.handle0(cell, kind, side, mx, my); // select\r\n    }\r\n\r\n    if (handle === 1) {\r\n      let swt = true;\r\n      this.props.insertStartingMeasureDisabler(swt);\r\n      this.handle1(cell); // notes\r\n    }\r\n\r\n    if (handle === 2) {\r\n      let swt = true;\r\n      this.props.insertStartingMeasureDisabler(swt);\r\n      this.handle2(cell); // bar\r\n    }\r\n\r\n    this.setState({ row });\r\n  };\r\n  handle0 = (cell, kind, side, mx, my) => {\r\n    let row = this.state.row;\r\n    let xValue = cell.x;\r\n    if (kind === 5) {\r\n      xValue = side;\r\n    }\r\n    let currentSelected = this.state.currentSelected;\r\n    row[currentSelected][0].selectColumn = false;\r\n    row[xValue][0].selectColumn = true;\r\n\r\n    if (row[xValue][0].starting === true) {\r\n      this.props.viewOptionOn();\r\n    } else {\r\n      this.props.viewOptionOff();\r\n    }\r\n    this.setState({\r\n      x: xValue,\r\n      currentSelected: xValue,\r\n    });\r\n\r\n    if (kind === 8) {\r\n      this.ks1(cell, xValue, mx, my);\r\n    }\r\n  };\r\n  handle1 = (cell) => {\r\n    // contain conlose -------------- passing------------\r\n    let row = this.state.row;\r\n    let currentCell = row[cell.x][cell.y]; // get x and y positions\r\n    let x = cell.x;\r\n    let note = this.props.note;\r\n    console.log(this.props);\r\n\r\n    if (row[x][0].starting === false) {\r\n      if (currentCell.isOpen === false) {\r\n        // 1. Find if one of the cells in current row has a True value for isOpen\r\n        let found = row[x].findIndex((cell) => {\r\n          if (cell.isOpen === true) return true;\r\n          else {\r\n            return false;\r\n          }\r\n        });\r\n        // 2. deside if it is going to make another row next to it or not.\r\n        if (found === -1 && row.length - 1 === x) {\r\n          // if none\r\n          this.setState({\r\n            currentIndex: x,\r\n          });\r\n          // this.createRow(); -----------------------------------------------------------------------------------\r\n        }\r\n        if (cell.x === 1) {\r\n          row[1][8].measure = 1;\r\n        }\r\n\r\n        currentCell.isOpen = true;\r\n        console.log(this.props.rest, currentCell.rest);\r\n        currentCell.rest = this.props.rest;\r\n        currentCell.note = note;\r\n        let kind = 6;\r\n        console.log(\"find Starting Measure\");\r\n        this.findStartingMeasure(x, kind);\r\n        //the length of the note should be equal to it's column\r\n        row[x].findIndex((cell) => {\r\n          cell.note = note;\r\n          return null;\r\n        });\r\n      } else {\r\n        // When Closing ------------------\r\n        currentCell.isOpen = false;\r\n        console.log(\"this will be CLOSE\");\r\n        let found = row[x].findIndex((cell) => {\r\n          // find if there is true in isOpen from the specific row clicked\r\n          if (cell.isOpen === true) return true;\r\n          else {\r\n            return false;\r\n          }\r\n        });\r\n        if (found === -1) {\r\n          console.log(x);\r\n          if (x !== 1) {\r\n            if (x + 1 !== row.length) {\r\n              if (row[x][8].barline === true) {\r\n                // if x has barline but to be removes, put it in the next x\r\n\r\n                if (row[x + 1][8].barline === false) {\r\n                  row[x + 1][8].barline = true;\r\n                  row[x + 1][8].measure = row[x][8].measure;\r\n                  row.splice(x, 1);\r\n                  this.decrementX(cell);\r\n                } else {\r\n                  let a = 0;\r\n                  while (a <= this.state.column - 1) {\r\n                    row[x][a].note = 0;\r\n                    a++;\r\n                  }\r\n                  let type = 1;\r\n                  let error = 0;\r\n                  let measure = row[x][8].measure;\r\n                  this.props.consoleWarningTS(type, measure, error);\r\n                }\r\n              } else {\r\n                row.splice(x, 1);\r\n                this.decrementX(cell);\r\n                return;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      this.setState({\r\n        x: x,\r\n      });\r\n    } else {\r\n      console.log(\"this is a starting measure\");\r\n    }\r\n  };\r\n  handle2 = (cell, kind, side) => {\r\n    // create barline--------------- passing function with console\r\n    let x = cell.x;\r\n    if (kind === 5) {\r\n      x = side;\r\n    }\r\n    let row = this.state.row;\r\n    console.log(x, row.length);\r\n    if (x === row.length) {\r\n      console.log(\"This is the last row last. Use End Bar line\");\r\n      return;\r\n    }\r\n    if (x === 0 || row[x][0].starting === true) {\r\n      // THIS IS STARTING, CAN'T CLICK\r\n      console.log(\"this is starting measure\");\r\n    } else {\r\n      if (row[x - 1][0].starting === false) {\r\n        if (row[x - 1][0].barline === true) {\r\n          console.log(\r\n            \"error: declaring barline without notes or rest between barlines\"\r\n          );\r\n        } else {\r\n          if (row[x][8].barline === false) {\r\n            //---- switch barline to TRUE\r\n            row[x][8].barline = true;\r\n            let kind = 1;\r\n            console.log(kind);\r\n            this.setState({ row });\r\n            this.findStartingMeasure(x, kind); //  ------  findStartingMeasure => checkingStartingTS => console => setMeasureNum => measureLengthCalc\r\n          } else {\r\n            // ----------------switch barline to FALSE\r\n            row[x][8].barline = false;\r\n            row[x][8].measure = null;\r\n            let kind = 2;\r\n            this.setState({ row });\r\n            this.findStartingMeasure(x, kind); //    ------  findStartingMeasure => checkingStartingTS => toLastNewMeasure => measureLengthCalc\r\n            let rowX;\r\n            this.setMeasureNum(x, rowX, kind);\r\n            let measure = 1;\r\n            for (let a = row.length - 1; a >= 1; a--) {\r\n              console.log(a, row[a][8].measure);\r\n              if (row[a][8].measure !== null) {\r\n                console.log(row[a][8]);\r\n                measure = row[a][8].measure + 1;\r\n                break;\r\n              }\r\n            }\r\n            this.props.recalcuConsoleMeasure(measure);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  };\r\n  setStarting = (cell) => {\r\n    // contain console ---------------------- passing function with console\r\n    let row = this.state.row;\r\n    let x = this.state.currentSelected;\r\n    row[x][0].clef = this.props.clef;\r\n    row[x][0].up = this.props.up;\r\n    row[x][0].down = this.props.down;\r\n    row[x][0].keySig = this.props.keySig;\r\n    //-------FOR TS -----------------------------\r\n    if (row[x][0].up === null || row[x][0].down === null) {\r\n      console.log(\" TS not complete\");\r\n    } else {\r\n      //then\r\n      if (x === 0) {\r\n        row[x + 1][8].measure = 1;\r\n      }\r\n\r\n      let type = 3;\r\n      let error = 4;\r\n      let measure = row[x + 1][8].measure;\r\n      console.log(type, measure, error);\r\n      this.props.removeWarning(type, measure, error);\r\n\r\n      this.calcDownUp(x);\r\n      let rowX = x;\r\n      let kind = 1;\r\n      this.measureLengthCalc(x + 1, rowX, kind);\r\n    }\r\n    //-------FOR Clef -----------------------------\r\n    if (row[x][0].Clef === null) {\r\n      console.log(\" clef not complete\");\r\n    } else {\r\n      let type = 4;\r\n      let error = 6;\r\n      let measure = row[x + 1][8].measure;\r\n      this.props.removeWarning(type, measure, error);\r\n      error = 7;\r\n      this.props.removeWarning(type, measure, error);\r\n      type = 5;\r\n      error = 11;\r\n      console.log(type, measure, error);\r\n      this.props.removeWarning(type, measure, error);\r\n      let currentSelected = x;\r\n      let kind = 8;\r\n      let mx = null;\r\n      let my = null;\r\n      this.ks2(cell, currentSelected, mx, my, kind);\r\n\r\n      row[x][0].keySig = \"C\";\r\n    }\r\n\r\n    this.setState({ row });\r\n\r\n    for (x = 0; x < row.length - 1; x++) {\r\n      if (row[x][0].starting === true) {\r\n        let clef = row[x][0].clef;\r\n        let up = row[x][0].up;\r\n        let down = row[x][0].down;\r\n        let keySig = row[x][0].keySig;\r\n        console.log(row[x][0], clef, up, down, keySig);\r\n      }\r\n    }\r\n  };\r\n  findStartingMeasure = (x, kind) => {\r\n    console.log(x, kind, \"Get Starting Position's X axis\");\r\n    let row = this.state.row;\r\n    let rowX = 0; //  row[X] Position -------------\r\n    for (let i = x; i >= 0; i--) {\r\n      // find Starting\r\n\r\n      if (row[i][0].starting === true) {\r\n        rowX = i;\r\n        break;\r\n      }\r\n    }\r\n    // -------------------------TS-----------------------------------\r\n    if (kind === 1) {\r\n      let kind = 1;\r\n      this.checkingStartingTS(x, rowX, kind);\r\n    }\r\n    if (kind === 2) {\r\n      let kind = 2;\r\n      this.toLastNewMeasure(x, rowX, kind);\r\n      this.measureLengthCalc(x, rowX, kind);\r\n    }\r\n    // -------------------------KS-----------------------------------\r\n    if (kind === 6) {\r\n      let kind = 6;\r\n      this.checkStartingClef(x, rowX, kind);\r\n    }\r\n  };\r\n  //----------------------------------------------------TS----------------------------------------------------------------------------------------\r\n  toLastNewMeasure = (x, rowX, kind) => {\r\n    console.log(\"Get last clicable position's X axis\");\r\n    let row = this.state.row;\r\n\r\n    if (kind === 2) {\r\n      let barCount = 0;\r\n      for (let a = rowX; a <= row.length - 2; a++) {\r\n        if (row[a + 1][0].starting === false) {\r\n          if (row[a + 1][8].barline === true) {\r\n            barCount = barCount + 1;\r\n            console.log(row[a + 1][0].starting);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (barCount === 0) {\r\n        let measure = row[rowX + 1][8].measure;\r\n        let type = 3;\r\n        let error = 4;\r\n        console.log(type, error, measure, row[rowX + 1][8].measure);\r\n\r\n        this.props.removeWarning(type, measure, error);\r\n      }\r\n      console.log(\"barcount =\", barCount);\r\n    }\r\n  };\r\n  checkingStartingTS = (x, rowX, kind) => {\r\n    console.log(x, rowX, \"Get Starting first measure's from left axis\");\r\n    let row = this.state.row;\r\n    if (kind === 1) {\r\n      let bLValrow = row[rowX][0].barLength;\r\n      let measure = row[rowX + 1][8].measure;\r\n      let type = 3;\r\n      let error = 4;\r\n      if (bLValrow === null) {\r\n        // Adding barline without declaring time signature for starting measure\r\n        let kind = 1;\r\n        console.log(type, error, measure, row[rowX + 1][8].measure);\r\n        this.setMeasureNum(x, rowX, kind); // --------------------measure numbers-----------\r\n        let up = row[rowX][0].up;\r\n        let down = row[rowX][0].down;\r\n        let barLength = row[rowX][0].barLength;\r\n        let totalNoteValue = row[rowX][0].totalNoteValue;\r\n        this.props.consoleWarningTS(\r\n          type,\r\n          measure,\r\n          error,\r\n          up,\r\n          down,\r\n          barLength,\r\n          totalNoteValue\r\n        );\r\n      } else {\r\n        // -----------------------if Up and Down are not Null\r\n        let kind = 1;\r\n        this.setMeasureNum(x, rowX, kind); // --------------------measure numbers-----------\r\n        console.log(\"hhh\");\r\n        this.measureLengthCalc(x, rowX, kind); //--------  proceed checking left and right measure\r\n      }\r\n    }\r\n    if (kind === 2) {\r\n      console.log(\"remove\");\r\n    }\r\n  };\r\n  setMeasureNum = (x, rowX, kind) => {\r\n    // set Measure Number\r\n    console.log(x, rowX, kind, \"Measure number or address\");\r\n    let row = this.state.row;\r\n    let measure = 1;\r\n    let kindHandler = 1;\r\n    if (kind === 3) {\r\n      kindHandler = 2;\r\n    }\r\n    for (let a = x - kindHandler; a >= 0; a--) {\r\n      if (a !== 0) {\r\n        if (row[a - 1][0].starting === true) {\r\n          measure = row[a][8].measure;\r\n          break;\r\n        }\r\n        if (row[a][8].barline === true) {\r\n          measure = row[a][8].measure;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    if (kind === 1) {\r\n      row[x][8].measure = measure + 1; // ------declare current measure number\r\n      measure = measure + 1;\r\n    }\r\n\r\n    if (kind === 3) {\r\n      measure = row[x][8].measure;\r\n    }\r\n\r\n    for (let b = x + 1; b <= row.length - 1; b++) {\r\n      if (row[b][0].starting === true) {\r\n        console.log(row[b + 1][8]);\r\n        row[b + 1][8].measure = measure + 1;\r\n        measure = measure + 1;\r\n        continue;\r\n      }\r\n\r\n      if (row[b][8].barline === true) {\r\n        row[b][8].measure = measure + 1;\r\n        measure = measure + 1;\r\n        continue;\r\n      }\r\n    }\r\n  };\r\n  measureLengthCalc = (x, rowX, kind) => {\r\n    // ------- get measure length   --- if kind 1, get measure length of left measure and right measure\r\n\r\n    let row = this.state.row;\r\n\r\n    let starting = x - 1;\r\n    let barLength = 0;\r\n    let newX = 1;\r\n    let measure = 1;\r\n    let loop = 1;\r\n    let up = null;\r\n    let down = null;\r\n\r\n    console.log(rowX, row[rowX]);\r\n    console.log(this.state.row);\r\n    barLength = row[rowX][0].barLength;\r\n    up = row[rowX][0].up;\r\n    down = row[rowX][0].down;\r\n    if (kind === 1) {\r\n      // if kind 1, need to do 2 loops\r\n      loop = row.length;\r\n    }\r\n    if (kind === 2) {\r\n      // if kind 1, need to do 2 loops\r\n      loop = row.length;\r\n    }\r\n\r\n    console.log(loop);\r\n    for (let l = 1; l <= loop; l++) {\r\n      // this is the loop       ------------ LOOP ------------\r\n\r\n      for (let n = starting; n >= 0; n--) {\r\n        // set the barLength\r\n        if (row[n][0].starting === true) {\r\n          barLength = row[n][0].barLength;\r\n          break;\r\n        }\r\n      }\r\n      console.log(\"loop number=\", l, \"Bar Length=\", barLength);\r\n      for (let n = starting; n >= 0; n--) {\r\n        // set the Strting POINT (newX) and measure   --- or The 1st column in  measure\r\n        if (row[n][0].starting === true) {\r\n          newX = n + 1;\r\n          measure = row[n + 1][8].measure;\r\n          break;\r\n        }\r\n        if (row[n][8].barline === true) {\r\n          newX = n;\r\n          measure = row[n][8].measure;\r\n          break;\r\n        }\r\n      }\r\n\r\n      console.log(\r\n        x,\r\n        starting,\r\n        kind,\r\n        \"Measure length Calc\",\r\n        \"newX =\",\r\n        newX,\r\n        \"Measure=\",\r\n        measure\r\n      );\r\n      //--------------------------------------------------\r\n      let ret = false;\r\n      let noteValue = [0]; // added Zero for reduce()\r\n      let nS = 0;\r\n      let nM = 0;\r\n      let nBL = barLength;\r\n\r\n      for (let b = newX; b <= row.length - 1; b++) {\r\n        if (row[b][0].starting === true) {\r\n          // break to the starting measure or a bar line\r\n\r\n          nS = b + 1;\r\n          nM = row[b + 1][8].measure;\r\n          console.log(row[b][0].barLength);\r\n          console.log(row[b][8], newX);\r\n          nBL = row[b][0].barLength;\r\n          if (row[b][0].barLength === null) {\r\n            // if the next starting measure's Time Siganture is NULL consoleWarn\r\n            for (let c = b; c <= row.length; c++) {\r\n              let type = 3;\r\n              let error = 4;\r\n              let measure = row[c][0].measure;\r\n              let up = row[c][0].up;\r\n              let barLength = row[c][0].barLength;\r\n              let down = row[c][0].down;\r\n              let totalNoteValue = row[rowX][0].totalNoteValue;\r\n              console.log(measure);\r\n              if (row[c][0].starting === true) {\r\n                this.props.consoleWarningTS(\r\n                  type,\r\n                  measure,\r\n                  error,\r\n                  up,\r\n                  down,\r\n                  barLength,\r\n                  totalNoteValue\r\n                );\r\n              } else {\r\n                b = c;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n\r\n          break;\r\n        }\r\n        if (row[b][8].barline === true) {\r\n          nS = b;\r\n          nM = row[b][8].measure;\r\n          console.log(row[b][8], newX);\r\n          if (b !== newX) {\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (row[b][0].note === 1) {\r\n          noteValue.push(4);\r\n        }\r\n        if (row[b][0].note === 2) {\r\n          noteValue.push(2);\r\n        }\r\n        if (row[b][0].note === 4) {\r\n          noteValue.push(1);\r\n        }\r\n\r\n        if (b === row.length - 1) {\r\n          ret = true;\r\n        }\r\n      }\r\n      let totalNoteValue = noteValue.reduce((accumulator, currentValue) => {\r\n        return accumulator + currentValue;\r\n      });\r\n\r\n      console.log(measure, barLength, \"vs\", totalNoteValue);\r\n      // -------------------------\r\n\r\n      let type = 1;\r\n      console.log(barLength, totalNoteValue, kind);\r\n      if (barLength === null) {\r\n        starting = nS;\r\n        measure = nM;\r\n        barLength = nBL;\r\n        console.log(starting, measure, barLength);\r\n        if (ret === true) {\r\n          console.log(\"Done\");\r\n          return;\r\n        }\r\n        continue;\r\n      }\r\n\r\n      if (barLength > totalNoteValue) {\r\n        let error = 1;\r\n        this.props.consoleWarningTS(\r\n          type,\r\n          measure,\r\n          error,\r\n          up,\r\n          down,\r\n          barLength,\r\n          totalNoteValue\r\n        );\r\n        console.log(\"kulang\");\r\n      }\r\n      if (barLength < totalNoteValue) {\r\n        let error = 2;\r\n        this.props.consoleWarningTS(\r\n          type,\r\n          measure,\r\n          error,\r\n          up,\r\n          down,\r\n          barLength,\r\n          totalNoteValue\r\n        );\r\n        console.log(\"sobra\");\r\n      }\r\n      if (barLength === totalNoteValue) {\r\n        console.log(\"chakto\");\r\n        this.props.removeWarning(type, measure);\r\n      }\r\n\r\n      // measure = nextMeasure\r\n      // barLength = nextBarLength\r\n      starting = nS;\r\n      measure = nM;\r\n      barLength = nBL;\r\n      console.log(starting, measure, barLength);\r\n      if (ret === true) {\r\n        console.log(\"Done\");\r\n        return;\r\n      }\r\n    }\r\n  };\r\n  calcDownUp = (x) => {\r\n    let row = this.state.row;\r\n    let up = this.props.up;\r\n    let down = this.props.down;\r\n    let calcDown = 0;\r\n    let c = 4;\r\n    let i = 0;\r\n    console.log(up, down);\r\n    while (calcDown !== 4 || i < 7) {\r\n      //current note value should be 4 && do while for 7 times only, limit to 7\r\n      calcDown = c * down;\r\n      if (calcDown !== 4) {\r\n        c = c / 2;\r\n      } else {\r\n        break;\r\n      }\r\n      i++;\r\n    }\r\n    let barLength = c * up;\r\n    console.log(barLength);\r\n    row[x][0].barLength = barLength;\r\n    this.setState({ row });\r\n  };\r\n  valuePerMeasureCalc = (cell, h, x, m) => {\r\n    // contain console\r\n    console.log(\"valuePerMeasureCalc\", cell, h, x, m);\r\n    let row = this.state.row;\r\n    let currentX = 0;\r\n    let starting = 0;\r\n    let barline = 1;\r\n    let startingMeasure = 0; //--- THIS IS THE MEASURE\r\n\r\n    for (let i = currentX; i >= 1; i--) {\r\n      // find Starting Measure\r\n      if (row[i][0].starting === false) {\r\n        if (row[i][8].barline === true) {\r\n          // if found...\r\n          barline = i;\r\n          break;\r\n        } else {\r\n          continue;\r\n        }\r\n      } else {\r\n        barline = i + 1;\r\n        break;\r\n      }\r\n    }\r\n    startingMeasure = row[barline][8].measure;\r\n    let measure = startingMeasure;\r\n\r\n    console.log(m);\r\n\r\n    //------------------------------------------------------------------------------------------------------------\r\n    let noteValue = [0]; // added Zero for reduce()\r\n    for (\r\n      let i = barline;\r\n      i <= row.length - 1 ||\r\n      row[i - 1][0].starting === true ||\r\n      row[i - 1][8].barline === true;\r\n      i++\r\n    ) {\r\n      // find end of Measure\r\n      console.log(barline, measure);\r\n      if (row[i][0].starting === false) {\r\n        if (row[i][8].barline === false) {\r\n          if (row[i][0].note === 1) {\r\n            console.log(\"pushed 4\");\r\n            noteValue.push(4);\r\n          }\r\n          if (row[i][0].note === 2) {\r\n            console.log(\"pushed 2\");\r\n            noteValue.push(2);\r\n          }\r\n          if (row[i][0].note === 4) {\r\n            console.log(\"pushed 1\");\r\n            noteValue.push(1);\r\n          }\r\n        } else {\r\n          break;\r\n        }\r\n      } else {\r\n        break;\r\n      }\r\n    }\r\n    console.log(noteValue);\r\n    let barLength = row[starting][0].barLength;\r\n    let totalNoteValue = noteValue.reduce((accumulator, currentValue) => {\r\n      return accumulator + currentValue;\r\n    });\r\n    console.log(startingMeasure, barLength, \"vs\", totalNoteValue);\r\n    let type = 1;\r\n    let up = row[starting][0].up;\r\n    let down = row[starting][0].down;\r\n    if (barLength > totalNoteValue) {\r\n      let error = 1;\r\n      this.props.consoleWarningTS(type, measure, error, up, down);\r\n      console.log(\"kulang\");\r\n      return;\r\n    }\r\n    if (barLength < totalNoteValue) {\r\n      let error = 2;\r\n      this.props.consoleWarningTS(type, measure, error, up, down);\r\n      console.log(\"sobra\");\r\n      return;\r\n    }\r\n    if (barLength === totalNoteValue) {\r\n      console.log(h, m);\r\n\r\n      console.log(\"chakto\");\r\n      this.props.removeWarning(type, measure, up, down);\r\n      return;\r\n    }\r\n    console.log(\r\n      currentX,\r\n      starting,\r\n      barline,\r\n      barLength,\r\n      totalNoteValue,\r\n      startingMeasure\r\n    );\r\n  };\r\n  //----------------------------------------------------Clef--------------------------------------------------------------------------------------\r\n\r\n  checkStartingClef = (x, rowX, kind) => {\r\n    let row = this.state.row;\r\n    let a = null;\r\n    if (kind === 6) {\r\n      a = rowX;\r\n    }\r\n    if (kind === 7) {\r\n      a = x;\r\n    }\r\n    console.log(row[a][0]);\r\n    if (row[a][0].clef === null) {\r\n      let type = 4;\r\n      let measure = row[a + 1][8].measure;\r\n      let error = 6;\r\n      this.props.consoleWarningClef(type, measure, error);\r\n    } else {\r\n      this.measureLengthCalc(x, rowX, kind);\r\n    }\r\n  };\r\n\r\n  //----------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n  componentDidMount() {\r\n    this.createMeasureRow();\r\n    this.createRow();\r\n    this.measure1();\r\n    this.props.insertStartingMeasure(this.insertStartingMeasure);\r\n    this.props.setStarting(this.setStarting);\r\n    this.props.removeStartingMeasure(this.removeStartingMeasure);\r\n  }\r\n\r\n  measure1() {\r\n    let row = this.state.row;\r\n    row[1][8].measure = 1;\r\n    this.setState({ row });\r\n  }\r\n\r\n  //-----------------------------RENDER HERE------------------------------------\r\n  render() {\r\n    let rows = this.state.row.map((row, index) => {\r\n      return (\r\n        <Row\r\n          cells={row}\r\n          key={index}\r\n          click={this.click}\r\n          clickLeft={this.clickLeft}\r\n          clickRight={this.clickRight}\r\n          ks1={this.ks1}\r\n          ks2={this.ks2}\r\n        />\r\n      );\r\n    });\r\n    return (\r\n      <div className=\"row\">\r\n        <div>\r\n          <Timer\r\n            row={this.state.row}\r\n            column={this.state.column}\r\n            tempo={this.props.tempo}\r\n            timeSig={this.props.timeSig}\r\n            currentSelected={this.state.currentSelected}\r\n            startPauseSwitch={this.props.startPauseSwitch}\r\n            clockStop={this.props.clockStop}\r\n            volume={this.props.volume}\r\n            playerIcon={this.props.playerIcon}\r\n            consoleWarningClef={this.props.consoleWarningClef}\r\n            metronome={this.props.metronome}\r\n          />\r\n        </div>\r\n\r\n        {rows}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Board;\r\n"]},"metadata":{},"sourceType":"module"}