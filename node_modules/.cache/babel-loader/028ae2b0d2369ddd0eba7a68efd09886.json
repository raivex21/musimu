{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nexport const userSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    username: null,\n    token: null,\n    first_name: null,\n    last_name: null,\n    userId: null,\n    error: null,\n    loading: false\n  },\n  reducers: {\n    authSuccess: (state, action) => {\n      state.username = action.payload.username;\n      state.token = action.payload.token;\n      state.last_name = action.payload.last_name;\n      state.first_name = action.payload.first_name;\n      state.userId = action.payload.userId;\n      state.expirationDate = action.payload.expirationDate.toString();\n    },\n    logout: state => {\n      localStorage.removeItem(\"user\");\n      state.username = null;\n      state.token = null;\n      state.first_name = null;\n      state.last_name = null;\n      state.userId = null;\n      state.expirationDate = null;\n    }\n  }\n});\nexport const {\n  authSuccess,\n  logout\n} = userSlice.actions; //if need dispatch; put here\n\nexport const authLogin = (username, password) => {\n  return dispatch => {\n    axios.post(\"http://127.0.0.1:8000/rest-auth/login/\", {\n      username: username,\n      password: password\n    }).then(res => {\n      console.log(res.data);\n      const user = {\n        token: res.data.key,\n        username,\n        last_name: res.data.user_detail.last_name,\n        first_name: res.data.user_detail.first_name,\n        userId: res.data.user_detail.userId,\n        expirationDate: new Date(new Date().getTime() + 86400 * 1000)\n      };\n      console.log(user);\n      localStorage.setItem(\"user\", JSON.stringify(user));\n      dispatch(authSuccess(user));\n      dispatch(checkAuthTimeout(86400));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nexport const checkAuthTimeout = expirationDate => {\n  return dispatch => {\n    setTimeout(() => {\n      dispatch(logout());\n    }, expirationDate * 1000);\n  };\n};\nexport const authCheckState = () => {\n  return dispatch => {\n    const user = JSON.parse(localStorage.getItem(\"user\"));\n\n    if (user === undefined || user === null) {\n      dispatch(logout());\n    } else {\n      const expirationDate = new Date(user.expirationDate);\n\n      if (expirationDate <= new Date()) {\n        dispatch(logout());\n      } else {\n        dispatch(authSuccess(user));\n        dispatch(checkAuthTimeout((expirationDate.getTime() - new Date().getTime()) / 1000));\n      }\n    }\n  };\n};\nexport const getUserList = token => {\n  return dispatch => {\n    axios.defaults.headers = {\n      headers: {\n        \"X-CSRFToken\": token\n      }\n    };\n    axios.get();\n  };\n};\nexport default userSlice.reducer;","map":{"version":3,"sources":["C:/Users/Raivex/Documents/React/Project/gui/src/features/userSlice.js"],"names":["createSlice","axios","userSlice","name","initialState","username","token","first_name","last_name","userId","error","loading","reducers","authSuccess","state","action","payload","expirationDate","toString","logout","localStorage","removeItem","actions","authLogin","password","dispatch","post","then","res","console","log","data","user","key","user_detail","Date","getTime","setItem","JSON","stringify","checkAuthTimeout","catch","err","setTimeout","authCheckState","parse","getItem","undefined","getUserList","defaults","headers","get","reducer"],"mappings":"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","sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\n\r\nexport const userSlice = createSlice({\r\n  name: \"user\",\r\n  initialState: {\r\n    username: null,\r\n    token: null,\r\n    first_name: null,\r\n    last_name: null,\r\n    userId: null,\r\n    error: null,\r\n    loading: false,\r\n  },\r\n  reducers: {\r\n    authSuccess: (state, action) => {\r\n      state.username = action.payload.username;\r\n      state.token = action.payload.token;\r\n      state.last_name = action.payload.last_name;\r\n      state.first_name = action.payload.first_name;\r\n      state.userId = action.payload.userId;\r\n      state.expirationDate = action.payload.expirationDate.toString();\r\n    },\r\n\r\n    logout: (state) => {\r\n      localStorage.removeItem(\"user\");\r\n      state.username = null;\r\n      state.token = null;\r\n      state.first_name = null;\r\n      state.last_name = null;\r\n      state.userId = null;\r\n      state.expirationDate = null;\r\n    },\r\n  },\r\n});\r\n\r\nexport const { authSuccess, logout } = userSlice.actions;\r\n\r\n//if need dispatch; put here\r\nexport const authLogin = (username, password) => {\r\n  return (dispatch) => {\r\n    axios\r\n      .post(\"http://127.0.0.1:8000/rest-auth/login/\", {\r\n        username: username,\r\n        password: password,\r\n      })\r\n      .then((res) => {\r\n        console.log(res.data);\r\n        const user = {\r\n          token: res.data.key,\r\n          username,\r\n          last_name: res.data.user_detail.last_name,\r\n          first_name: res.data.user_detail.first_name,\r\n          userId: res.data.user_detail.userId,\r\n          expirationDate: new Date(new Date().getTime() + 86400 * 1000),\r\n        };\r\n        console.log(user);\r\n        localStorage.setItem(\"user\", JSON.stringify(user));\r\n        dispatch(authSuccess(user));\r\n        dispatch(checkAuthTimeout(86400));\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n};\r\n\r\nexport const checkAuthTimeout = (expirationDate) => {\r\n  return (dispatch) => {\r\n    setTimeout(() => {\r\n      dispatch(logout());\r\n    }, expirationDate * 1000);\r\n  };\r\n};\r\n\r\nexport const authCheckState = () => {\r\n  return (dispatch) => {\r\n    const user = JSON.parse(localStorage.getItem(\"user\"));\r\n    if (user === undefined || user === null) {\r\n      dispatch(logout());\r\n    } else {\r\n      const expirationDate = new Date(user.expirationDate);\r\n      if (expirationDate <= new Date()) {\r\n        dispatch(logout());\r\n      } else {\r\n        dispatch(authSuccess(user));\r\n        dispatch(\r\n          checkAuthTimeout(\r\n            (expirationDate.getTime() - new Date().getTime()) / 1000\r\n          )\r\n        );\r\n      }\r\n    }\r\n  };\r\n};\r\n\r\nexport const getUserList = (token) => {\r\n  return (dispatch) => {\r\n    axios.defaults.headers = {\r\n      headers: { \"X-CSRFToken\": token },\r\n    };\r\n    axios.get();\r\n  };\r\n};\r\n\r\nexport default userSlice.reducer;\r\n"]},"metadata":{},"sourceType":"module"}